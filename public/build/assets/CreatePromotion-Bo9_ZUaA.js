import{u as B,x as k,p as b,i as g,c as i,o as n,a as s,b as w,w as V,d as U,e as d,l as C,g as x,f as u,v as p,k as _,F as q,r as S,t as a,m as F,h as G}from"./app-BtZeyPR9.js";const j={class:"p-6 max-w-4xl mx-auto space-y-6"},z={class:"flex justify-between items-center"},A={class:"space-y-2"},I=["value"],T={key:0,class:"text-red-600 text-xs mt-1"},E={key:0},$={key:0,class:"text-red-600 text-xs mt-1"},H={key:1,class:"space-y-4"},J={class:"space-y-2"},K=["value"],O={key:0,class:"text-red-600 text-xs mt-1"},Q={key:0,class:"text-red-600 text-xs mt-1"},R={class:"grid grid-cols-1 sm:grid-cols-3 gap-4"},W={class:"flex justify-end space-x-3"},X=["disabled"],Z={__name:"CreatePromotion",props:{products:Array,types:Array},setup(N){const m=N,o=B({product_id:"",type:"discount",title:"",discount_price:"",gift_product_id:"",gift_quantity:1,is_active:!0,starts_at:"",ends_at:"",priority:100}),f=k(""),c=b(()=>m.products.find(l=>l.id===Number(o.product_id))),P=b(()=>{if(!f.value)return m.products;const l=f.value.toLowerCase();return m.products.filter(t=>{var e,r;return((r=(e=t.translation)==null?void 0:e.name)==null?void 0:r.toLowerCase().includes(l))||String(t.id).includes(l)})});g(()=>o.product_id,()=>{var l;c.value&&(f.value=((l=c.value.translation)==null?void 0:l.name)||"")}),g(()=>f.value,l=>{var t;c.value&&l!==((t=c.value.translation)==null?void 0:t.name)&&(o.product_id="")});const v=k(""),y=b(()=>m.products.find(l=>l.id===Number(o.gift_product_id))),D=b(()=>{if(!v.value)return m.products;const l=v.value.toLowerCase();return m.products.filter(t=>{var e,r;return((r=(e=t.translation)==null?void 0:e.name)==null?void 0:r.toLowerCase().includes(l))||String(t.id).includes(l)})});g(()=>o.gift_product_id,()=>{var l;y.value&&(v.value=((l=y.value.translation)==null?void 0:l.name)||"")}),g(()=>v.value,l=>{var t;y.value&&l!==((t=y.value.translation)==null?void 0:t.name)&&(o.gift_product_id="")});const L=b(()=>o.type==="discount"),M=b(()=>o.type==="gift");return(l,t)=>(n(),i("div",j,[s("div",z,[t[13]||(t[13]=s("h1",{class:"text-xl font-semibold text-admin-text"},"Создание акции",-1)),w(d(C),{href:l.route("admin.promotions.index"),class:"text-sm text-admin-muted hover:underline"},{default:V(()=>t[12]||(t[12]=[U("← Назад",-1)])),_:1,__:[12]},8,["href"])]),s("form",{onSubmit:t[11]||(t[11]=G(e=>d(o).post(l.route("admin.promotions.store")),["prevent"])),class:"bg-white border border-gray-300 rounded-lg p-6 space-y-6"},[s("div",null,[t[14]||(t[14]=s("label",{class:"block text-sm font-medium mb-1"},"Товар",-1)),s("div",A,[u(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>f.value=e),type:"text",placeholder:"Поиск товара...",class:"w-full border rounded px-3 py-2 text-sm"},null,512),[[p,f.value]]),u(s("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>d(o).product_id=e),size:"6",class:"w-full border rounded px-3 py-2"},[(n(!0),i(q,null,S(P.value,e=>{var r;return n(),i("option",{key:e.id,value:e.id},a(((r=e.translation)==null?void 0:r.name)||"—")+" (ID "+a(e.id)+") ",9,I)}),128))],512),[[_,d(o).product_id]])]),d(o).errors.product_id?(n(),i("div",T,a(d(o).errors.product_id),1)):x("",!0)]),s("div",null,[t[16]||(t[16]=s("label",{class:"block text-sm font-medium mb-1"},"Тип акции",-1)),u(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>d(o).type=e),class:"w-full border rounded px-3 py-2"},t[15]||(t[15]=[s("option",{value:"discount"},"Скидка",-1),s("option",{value:"gift"},"Подарок",-1)]),512),[[_,d(o).type]])]),s("div",null,[t[17]||(t[17]=s("label",{class:"block text-sm font-medium mb-1"},"Название (опционально)",-1)),u(s("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>d(o).title=e),type:"text",class:"w-full border rounded px-3 py-2"},null,512),[[p,d(o).title]])]),L.value?(n(),i("div",E,[t[18]||(t[18]=s("label",{class:"block text-sm font-medium mb-1"},"Цена по акции",-1)),u(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>d(o).discount_price=e),type:"number",step:"0.01",class:"w-full border rounded px-3 py-2"},null,512),[[p,d(o).discount_price]]),d(o).errors.discount_price?(n(),i("div",$,a(d(o).errors.discount_price),1)):x("",!0)])):x("",!0),M.value?(n(),i("div",H,[s("div",null,[t[19]||(t[19]=s("label",{class:"block text-sm font-medium mb-1"},"Товар-подарок",-1)),s("div",J,[u(s("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>v.value=e),type:"text",placeholder:"Поиск подарка...",class:"w-full border rounded px-3 py-2 text-sm"},null,512),[[p,v.value]]),u(s("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>d(o).gift_product_id=e),size:"6",class:"w-full border rounded px-3 py-2"},[(n(!0),i(q,null,S(D.value,e=>{var r;return n(),i("option",{key:e.id,value:e.id},a(((r=e.translation)==null?void 0:r.name)||"—")+" (ID "+a(e.id)+") ",9,K)}),128))],512),[[_,d(o).gift_product_id]])]),d(o).errors.gift_product_id?(n(),i("div",O,a(d(o).errors.gift_product_id),1)):x("",!0)]),s("div",null,[t[20]||(t[20]=s("label",{class:"block text-sm font-medium mb-1"},"Количество",-1)),u(s("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>d(o).gift_quantity=e),type:"number",min:"1",class:"w-full border rounded px-3 py-2"},null,512),[[p,d(o).gift_quantity]]),d(o).errors.gift_quantity?(n(),i("div",Q,a(d(o).errors.gift_quantity),1)):x("",!0)])])):x("",!0),s("div",R,[s("div",null,[t[21]||(t[21]=s("label",{class:"block text-sm font-medium mb-1"},"Активна",-1)),u(s("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=e=>d(o).is_active=e)},null,512),[[F,d(o).is_active]])]),s("div",null,[t[22]||(t[22]=s("label",{class:"block text-sm font-medium mb-1"},"Дата начала",-1)),u(s("input",{type:"date","onUpdate:modelValue":t[9]||(t[9]=e=>d(o).starts_at=e),class:"w-full border rounded px-3 py-2"},null,512),[[p,d(o).starts_at]])]),s("div",null,[t[23]||(t[23]=s("label",{class:"block text-sm font-medium mb-1"},"Дата окончания",-1)),u(s("input",{type:"date","onUpdate:modelValue":t[10]||(t[10]=e=>d(o).ends_at=e),class:"w-full border rounded px-3 py-2"},null,512),[[p,d(o).ends_at]])])]),s("div",W,[w(d(C),{href:l.route("admin.promotions.index"),class:"px-4 py-2 border rounded-lg hover:bg-gray-100 transition"},{default:V(()=>t[24]||(t[24]=[U(" Отмена ",-1)])),_:1,__:[24]},8,["href"]),s("button",{type:"submit",disabled:d(o).processing,class:"bg-admin-primary text-white px-6 py-2 rounded-lg hover:bg-admin-muted transition"}," Создать ",8,X)])],32)]))}};export{Z as default};
