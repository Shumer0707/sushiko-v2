import{u as h,q as A,c as d,o as i,a as e,f as p,g as m,k as g,e as o,F as f,r as x,t as n,v as b,m as w,b as N,w as M,d as S,l as C,h as E}from"./app-QRAPOiZp.js";const B={class:"p-6 max-w-7xl mx-auto space-y-8 text-admin-text"},D={class:"space-y-4"},F={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},I=["value"],L={key:0,class:"text-red-500 text-sm mt-1"},T=["value"],j={key:0,class:"text-red-500 text-sm mt-1"},q={key:0,class:"text-red-500 text-sm mt-1"},z={key:0,class:"text-red-500 text-sm mt-1"},K={key:0,class:"text-red-500 text-sm mt-1"},O={class:"flex items-center gap-2"},G={class:"space-y-4"},H={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},J={class:"font-semibold uppercase"},P=["onUpdate:modelValue"],Q={key:0,class:"text-red-500 text-sm mt-1"},R=["onUpdate:modelValue"],W={key:0,class:"text-red-500 text-sm mt-1"},X=["onUpdate:modelValue"],Y=["onUpdate:modelValue"],Z={class:"space-y-2"},tt={key:0,class:"text-red-500 text-sm mt-1"},et={class:"space-y-4"},st={class:"block font-semibold mb-2"},rt={class:"flex flex-wrap gap-3"},ot=["for"],lt=["id","value","onUpdate:modelValue"],dt={key:0,class:"text-red-500 text-sm mt-2"},it={class:"flex gap-2"},at={__name:"Create",props:{brands:{type:Array,default:()=>[]},categories:{type:Array,default:()=>[]},attributes:{type:Array,default:()=>[]}},setup(V){const y=V,r=h({brand_id:null,category_id:null,sku:"",price:0,currency:"MDL",is_active:!0,sort_order:0,translations:{ru:{name:"",slug:"",short_description:"",full_description:""},ro:{name:"",slug:"",short_description:"",full_description:""},en:{name:"",slug:"",short_description:"",full_description:""}},images:[],attributes:{}}),U=a=>{r.images=Array.from(a.target.files||[])};A(()=>{y.attributes.forEach(a=>{Array.isArray(r.attributes[a.id])||(r.attributes[a.id]=[])})}),r.transform(a=>{const t={};y.attributes.forEach(l=>{t[l.id]=new Set((l.values||[]).map(u=>Number(u.id)))});const s={};return Object.keys(t).forEach(l=>{var k;const u=Number(l),c=(k=a.attributes)==null?void 0:k[u],_=Array.isArray(c)?c:c!=null?[c]:[];s[u]=_.map(v=>Number(v)).filter(v=>Number.isInteger(v)&&t[u].has(v))}),{...a,attributes:s}});const $=()=>{y.attributes.forEach(a=>{Array.isArray(r.attributes[a.id])||(r.attributes[a.id]=[])}),r.post(route("admin.products.store"))};return(a,t)=>(i(),d("div",B,[t[26]||(t[26]=e("h1",{class:"text-xl font-semibold"},"Добавить товар",-1)),e("form",{onSubmit:E($,["prevent"]),class:"space-y-8"},[e("div",D,[t[16]||(t[16]=e("h2",{class:"text-lg font-semibold"},"Основные данные",-1)),e("div",F,[e("div",null,[t[8]||(t[8]=e("label",{class:"block font-semibold mb-1"},"Бренд",-1)),p(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o(r).brand_id=s),class:"w-full rounded border px-2 py-1 bg-white"},[t[7]||(t[7]=e("option",{value:null},"— не выбран —",-1)),(i(!0),d(f,null,x(y.brands,s=>{var l;return i(),d("option",{key:s.id,value:s.id},n(((l=s.translation)==null?void 0:l.name)??`#${s.id}`),9,I)}),128))],512),[[g,o(r).brand_id]]),o(r).errors.brand_id?(i(),d("div",L,n(o(r).errors.brand_id),1)):m("",!0)]),e("div",null,[t[10]||(t[10]=e("label",{class:"block font-semibold mb-1"},"Категория",-1)),p(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o(r).category_id=s),class:"w-full rounded border px-2 py-1 bg-white"},[t[9]||(t[9]=e("option",{value:null},"— не выбрана —",-1)),(i(!0),d(f,null,x(y.categories,s=>{var l;return i(),d("option",{key:s.id,value:s.id},n(((l=s.translation)==null?void 0:l.name)??`#${s.id}`),9,T)}),128))],512),[[g,o(r).category_id]]),o(r).errors.category_id?(i(),d("div",j,n(o(r).errors.category_id),1)):m("",!0)]),e("div",null,[t[11]||(t[11]=e("label",{class:"block font-semibold mb-1"},"SKU",-1)),p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>o(r).sku=s),class:"w-full rounded border px-2 py-1"},null,512),[[b,o(r).sku]]),o(r).errors.sku?(i(),d("div",q,n(o(r).errors.sku),1)):m("",!0)]),e("div",null,[t[12]||(t[12]=e("label",{class:"block font-semibold mb-1"},"Цена",-1)),p(e("input",{type:"number",step:"0.01","onUpdate:modelValue":t[3]||(t[3]=s=>o(r).price=s),class:"w-full rounded border px-2 py-1"},null,512),[[b,o(r).price,void 0,{number:!0}]]),o(r).errors.price?(i(),d("div",z,n(o(r).errors.price),1)):m("",!0)]),e("div",null,[t[13]||(t[13]=e("label",{class:"block font-semibold mb-1"},"Валюта",-1)),p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o(r).currency=s),class:"w-full rounded border px-2 py-1"},null,512),[[b,o(r).currency]]),o(r).errors.currency?(i(),d("div",K,n(o(r).errors.currency),1)):m("",!0)]),e("div",O,[p(e("input",{id:"is_active",type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=s=>o(r).is_active=s)},null,512),[[w,o(r).is_active]]),t[14]||(t[14]=e("label",{for:"is_active",class:"font-semibold"},"Активен",-1))]),e("div",null,[t[15]||(t[15]=e("label",{class:"block font-semibold mb-1"},"Порядок",-1)),p(e("input",{type:"number",min:"0","onUpdate:modelValue":t[6]||(t[6]=s=>o(r).sort_order=s),class:"w-full rounded border px-2 py-1"},null,512),[[b,o(r).sort_order,void 0,{number:!0}]])])])]),e("div",G,[t[21]||(t[21]=e("h2",{class:"text-lg font-semibold"},"Переводы",-1)),e("div",H,[(i(),d(f,null,x(["ru","ro","en"],s=>e("div",{key:s,class:"space-y-2"},[e("h3",J,n(s),1),e("div",null,[t[17]||(t[17]=e("label",{class:"block"},"Название",-1)),p(e("input",{"onUpdate:modelValue":l=>o(r).translations[s].name=l,class:"w-full rounded border px-2 py-1"},null,8,P),[[b,o(r).translations[s].name]]),o(r).errors[`translations.${s}.name`]?(i(),d("div",Q,n(o(r).errors[`translations.${s}.name`]),1)):m("",!0)]),e("div",null,[t[18]||(t[18]=e("label",{class:"block"},"Slug",-1)),p(e("input",{"onUpdate:modelValue":l=>o(r).translations[s].slug=l,class:"w-full rounded border px-2 py-1"},null,8,R),[[b,o(r).translations[s].slug]]),o(r).errors[`translations.${s}.slug`]?(i(),d("div",W,n(o(r).errors[`translations.${s}.slug`]),1)):m("",!0)]),e("div",null,[t[19]||(t[19]=e("label",{class:"block"},"Кратко",-1)),p(e("textarea",{"onUpdate:modelValue":l=>o(r).translations[s].short_description=l,class:"w-full rounded border px-2 py-1",rows:"3"},null,8,X),[[b,o(r).translations[s].short_description]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block"},"Полное описание",-1)),p(e("textarea",{"onUpdate:modelValue":l=>o(r).translations[s].full_description=l,class:"w-full rounded border px-2 py-1",rows:"5"},null,8,Y),[[b,o(r).translations[s].full_description]])])])),64))])]),e("div",Z,[t[22]||(t[22]=e("h2",{class:"text-lg font-semibold"},"Галерея",-1)),e("input",{type:"file",multiple:"",onChange:U},null,32),o(r).errors["images.0"]?(i(),d("div",tt,"Проверьте форматы и размер файлов")):m("",!0)]),e("div",et,[t[23]||(t[23]=e("h2",{class:"text-lg font-semibold"},"Атрибуты",-1)),(i(!0),d(f,null,x(y.attributes,s=>{var l;return i(),d("div",{key:s.id,class:"rounded border p-4 bg-white/50"},[e("label",st,n(((l=s.translation)==null?void 0:l.name)??`#${s.id}`),1),e("div",rt,[(i(!0),d(f,null,x(s.values||[],u=>{var c;return i(),d("label",{key:u.id,class:"inline-flex items-center gap-2 text-sm px-2 py-1 rounded hover:bg-admin-muted/10 transition",for:`attr-${s.id}-val-${u.id}`},[p(e("input",{class:"rounded",type:"checkbox",id:`attr-${s.id}-val-${u.id}`,value:u.id,"onUpdate:modelValue":_=>o(r).attributes[s.id]=_},null,8,lt),[[w,o(r).attributes[s.id]]]),e("span",null,n(((c=u.translation)==null?void 0:c.value)??`#${u.id}`),1)],8,ot)}),128))]),o(r).errors[`attributes.${s.id}`]?(i(),d("div",dt,n(o(r).errors[`attributes.${s.id}`]),1)):m("",!0)])}),128))]),e("div",it,[t[25]||(t[25]=e("button",{class:"bg-admin-primary text-white px-4 py-2 rounded-lg hover:bg-admin-muted transition"}," Сохранить ",-1)),N(o(C),{href:a.route("admin.products.index"),class:"px-4 py-2 border rounded-lg hover:bg-white transition"},{default:M(()=>t[24]||(t[24]=[S(" Отмена ",-1)])),_:1,__:[24]},8,["href"])])],32)]))}};export{at as default};
